local player = game.Players.LocalPlayer
local mouse = player:GetMouse()

-- Create ScreenGui
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "PetAgeGui"
screenGui.ResetOnSpawn = false
screenGui.Parent = player:WaitForChild("PlayerGui")

-- Create Button
local button = Instance.new("TextButton")
button.Size = UDim2.new(0, 140, 0, 50)
button.Position = UDim2.new(1, -150, 0.5, -25) -- middle-right with anchor
button.AnchorPoint = Vector2.new(1, 0.5)
button.BackgroundColor3 = Color3.fromRGB(0, 170, 255)
button.TextColor3 = Color3.new(1, 1, 1)
button.Font = Enum.Font.SourceSansBold
button.TextSize = 22
button.Text = "Age to 50"
button.Parent = screenGui

-- Create Loading Frame (progress bar background)
local loadingFrame = Instance.new("Frame")
loadingFrame.Size = UDim2.new(0, 140, 0, 20)
loadingFrame.Position = UDim2.new(1, -150, 0.5, 40)
loadingFrame.AnchorPoint = Vector2.new(1, 0.5)
loadingFrame.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
loadingFrame.BorderSizePixel = 0
loadingFrame.Visible = false
loadingFrame.Parent = screenGui

-- Create Progress Bar (progress fill)
local progressBar = Instance.new("Frame")
progressBar.Size = UDim2.new(0, 0, 1, 0) -- starts empty
progressBar.BackgroundColor3 = Color3.fromRGB(0, 255, 0)
progressBar.BorderSizePixel = 0
progressBar.Parent = loadingFrame

-- Create Percentage Text
local percentText = Instance.new("TextLabel")
percentText.Size = UDim2.new(1, 0, 1, 0)
percentText.BackgroundTransparency = 1
percentText.TextColor3 = Color3.new(1, 1, 1)
percentText.Font = Enum.Font.SourceSansBold
percentText.TextSize = 18
percentText.Text = "0%"
percentText.Parent = loadingFrame

-- Variables for timing
local totalDuration = 300 -- 5 minutes in seconds
local agingGoal = 50

-- Function to get held pet
local function getHeldPet()
    -- Change this logic depending on your pet holding system
    -- Example: pet is a Tool held by player or pet is character child
    -- Here's a generic example: check if player's character has a child named "Pet" (change to your game logic)
    local character = player.Character
    if not character then return nil end

    -- Example: assume held pet is a child named "Pet" under character
    local pet = character:FindFirstChild("Pet")
    return pet
end

-- Main logic for aging pet gradually
local agingInProgress = false
local heldPet = nil

local function startAgingProcess()
    if agingInProgress then return end -- prevent multiple presses

    heldPet = getHeldPet()
    if not heldPet then
        button.Text = "No pet held!"
        wait(2)
        button.Text = "Age to 50"
        return
    end

    local currentAgeValue = heldPet:FindFirstChild("Age")
    if not currentAgeValue or not currentAgeValue:IsA("IntValue") then
        button.Text = "Pet has no Age"
        wait(2)
        button.Text = "Age to 50"
        return
    end

    local currentAge = currentAgeValue.Value
    if currentAge >= agingGoal then
        button.Text = "Already 50+"
        wait(2)
        button.Text = "Age to 50"
        return
    end

    agingInProgress = true
    button.Text = "Aging..."

    loadingFrame.Visible = true
    progressBar.Size = UDim2.new(0, 0, 1, 0)
    percentText.Text = "0%"

    local startTime = tick()
    local endTime = startTime + totalDuration

    -- We'll update the age incrementally as the progress goes
    while tick() < endTime do
        local now = tick()
        local elapsed = now - startTime
        local progress = math.clamp(elapsed / totalDuration, 0, 1)

        -- Update progress bar size and percent text
        progressBar.Size = UDim2.new(progress, 0, 1, 0)
        percentText.Text = string.format("%d%%", math.floor(progress * 100))

        -- Calculate new age based on progress
        local newAge = math.floor(currentAge + (agingGoal - currentAge) * progress)
        if newAge > currentAgeValue.Value then
            currentAgeValue.Value = newAge
        end

        wait(0.1) -- update 10 times per second
    end

    -- Ensure final age is set to 50
    currentAgeValue.Value = agingGoal

    percentText.Text = "100%"
    button.Text = "Done!"

    wait(2)

    button.Text = "Age to 50"
    loadingFrame.Visible = false
    agingInProgress = false
end

-- Button events
button.MouseButton1Down:Connect(function()
    startAgingProcess()
end)
