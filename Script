-- Services
local Players = game:GetService("Players")
local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()

-- UI Setup
local screenGui = Instance.new("ScreenGui", player:WaitForChild("PlayerGui"))
screenGui.Name = "PetAgeGui"

local button = Instance.new("TextButton")
button.Size = UDim2.new(0, 120, 0, 40)
button.Position = UDim2.new(1, -130, 0.5, -20) -- Middle right
button.AnchorPoint = Vector2.new(0, 0)
button.Text = "Age Pet"
button.BackgroundColor3 = Color3.fromRGB(40, 170, 255)
button.TextColor3 = Color3.new(1, 1, 1)
button.Font = Enum.Font.SourceSansBold
button.TextSize = 20
button.Parent = screenGui

local loadingBar = Instance.new("Frame", screenGui)
loadingBar.Size = UDim2.new(0, 0, 0, 10)
loadingBar.Position = UDim2.new(0.5, -75, 0.5, 30)
loadingBar.BackgroundColor3 = Color3.fromRGB(0, 255, 0)
loadingBar.BorderSizePixel = 0
loadingBar.Visible = false

local loadingBG = Instance.new("Frame", screenGui)
loadingBG.Size = UDim2.new(0, 150, 0, 10)
loadingBG.Position = UDim2.new(0.5, -75, 0.5, 30)
loadingBG.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
loadingBG.BorderSizePixel = 0
loadingBG.Visible = false

-- Find held pet
local function getHeldPet()
	for _, tool in ipairs(character:GetChildren()) do
		if tool:IsA("Tool") and tool:FindFirstChild("Handle") then
			return tool
		end
	end
	return nil
end

-- Add visual age label
local function setupAgeLabel(pet)
	if not pet:FindFirstChild("AgeLabel") then
		local label = Instance.new("BillboardGui", pet)
		label.Name = "AgeLabel"
		label.Size = UDim2.new(0, 100, 0, 30)
		label.StudsOffset = Vector3.new(0, 2, 0)
		label.AlwaysOnTop = true

		local text = Instance.new("TextLabel", label)
		text.Size = UDim2.new(1, 0, 1, 0)
		text.BackgroundTransparency = 1
		text.TextColor3 = Color3.fromRGB(255, 255, 255)
		text.TextScaled = true
		text.Font = Enum.Font.GothamBold
		text.Text = "[Age 0]"
	end
end

-- Get current age number
local function getCurrentAge(pet)
	local label = pet:FindFirstChild("AgeLabel")
	if label then
		local textLabel = label:FindFirstChildOfClass("TextLabel")
		if textLabel then
			local ageStr = string.match(textLabel.Text, "%[Age (%d+)%]")
			return tonumber(ageStr) or 0
		end
	end
	return 0
end

-- Update age
local function setAge(pet, newAge)
	local label = pet:FindFirstChild("AgeLabel")
	if label then
		local textLabel = label:FindFirstChildOfClass("TextLabel")
		if textLabel then
			textLabel.Text = string.format("[Age %d]", newAge)
		end
	end
end

-- Handle button click
local isRunning = false
button.MouseButton1Click:Connect(function()
	if isRunning then return end

	local pet = getHeldPet()
	if not pet then
		button.Text = "No Pet Held"
		wait(2)
		button.Text = "Age Pet"
		return
	end

	setupAgeLabel(pet)
	isRunning = true
	button.Text = "Aging..."
	loadingBG.Visible = true
	loadingBar.Visible = true

	for i = 1, 100 do
		loadingBar.Size = UDim2.new(0, i * 1.5, 0, 10)
		wait(3) -- 3 seconds x 100 = 300s = 5 minutes
	end

	local currentAge = getCurrentAge(pet)
	setAge(pet, currentAge + 1)

	-- Reset UI
	loadingBar.Visible = false
	loadingBar.Size = UDim2.new(0, 0, 0, 10)
	loadingBG.Visible = false
	button.Text = "Age Pet"
	isRunning = false
end)
