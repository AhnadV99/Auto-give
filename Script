-- LocalScript inside a ScreenGui
local Players = game:GetService("Players")
local player = Players.LocalPlayer
local RunService = game:GetService("RunService")

-- UI Setup
local gui = script.Parent

local button = Instance.new("TextButton")
button.Size = UDim2.new(0, 120, 0, 40)
button.Position = UDim2.new(1, -140, 0.5, -20)
button.AnchorPoint = Vector2.new(0, 0.5)
button.Text = "Age to 50"
button.BackgroundColor3 = Color3.fromRGB(0, 170, 255)
button.TextColor3 = Color3.new(1,1,1)
button.Parent = gui

local progressBar = Instance.new("Frame")
progressBar.Size = UDim2.new(0, 0, 0, 10)
progressBar.Position = UDim2.new(0.5, -100, 0.5, 30)
progressBar.BackgroundColor3 = Color3.fromRGB(0, 255, 0)
progressBar.BorderSizePixel = 0
progressBar.Visible = false
progressBar.Parent = gui

local percentageLabel = Instance.new("TextLabel")
percentageLabel.Size = UDim2.new(0, 80, 0, 20)
percentageLabel.Position = UDim2.new(0.5, -40, 0.5, 45)
percentageLabel.BackgroundTransparency = 1
percentageLabel.TextColor3 = Color3.new(1, 1, 1)
percentageLabel.Text = "0%"
percentageLabel.Visible = false
percentageLabel.Parent = gui

-- Find held pet function
local function getHeldPet()
	for _, tool in pairs(player.Character:GetChildren()) do
		if tool:IsA("Tool") and tool:FindFirstChild("Handle") then
			return tool
		end
	end
	return nil
end

-- Update Age visually
local function updatePetAgeText(pet, newAge)
	for _, v in pairs(pet:GetChildren()) do
		if v:IsA("BillboardGui") then
			for _, label in pairs(v:GetDescendants()) do
				if label:IsA("TextLabel") and label.Text:find("Age") then
					label.Text = "[Age " .. tostring(newAge) .. "]"
				end
			end
		end
	end
end

-- Main button click logic
local isRunning = false

button.MouseButton1Click:Connect(function()
	if isRunning then return end

	local pet = getHeldPet()
	if not pet then
		warn("No pet held.")
		return
	end

	local currentAge = 0

	-- Try to find current age visually
	for _, gui in pairs(pet:GetDescendants()) do
		if gui:IsA("TextLabel") and gui.Text:find("Age") then
			local found = gui.Text:match("Age (%d+)")
			if found then
				currentAge = tonumber(found)
			end
		end
	end

	if currentAge >= 50 then
		warn("Already at age 50 or more.")
		return
	end

	isRunning = true
	button.Text = "Aging..."
	progressBar.Visible = true
	percentageLabel.Visible = true

	local duration = 300 -- 5 minutes in seconds
	local targetAge = 50
	local startAge = currentAge
	local startTime = tick()

	local heartbeatConn
	heartbeatConn = RunService.Heartbeat:Connect(function()
		local elapsed = tick() - startTime
		local progress = math.clamp(elapsed / duration, 0, 1)
		local displayAge = math.floor(startAge + (targetAge - startAge) * progress)
		local percent = math.floor(progress * 100)

		progressBar.Size = UDim2.new(progress, 0, 0, 10)
		percentageLabel.Text = percent .. "%"

		updatePetAgeText(pet, displayAge)

		if progress >= 1 then
			heartbeatConn:Disconnect()
			button.Text = "Age to 50"
			progressBar.Visible = false
			percentageLabel.Visible = false
			isRunning = false
		end
	end)
end)
