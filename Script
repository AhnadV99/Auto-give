-- ‚úÖ Grow a Garden: Chat Controlled Version by Zeetuan

local player = game.Players.LocalPlayer
local char = player.Character or player.CharacterAdded:Wait()
local hrp = char:WaitForChild("HumanoidRootPart")
local autoCollect = false
local autoGive = false

local fruitNames = {
    "Tomato", "Green Apple", "Avocado", "Sugar Apple",
    "Prickly Pear", "Loquat", "Cauliflower", "Feijoa",
    "Bell Pepper", "Kiwi"
}

-- üí¨ CHAT COMMANDS
player.Chatted:Connect(function(msg)
	msg = msg:lower()
	if msg == "!collect" then
		autoCollect = not autoCollect
		print("[Auto Collect] is now", autoCollect and "ON" or "OFF")
	elseif msg == "!give" then
		autoGive = not autoGive
		print("[Auto Give] is now", autoGive and "ON" or "OFF")
	elseif msg == "!buycandy" then
		local success, err = pcall(function()
			local remote = game:GetService("ReplicatedStorage"):FindFirstChild("BuySeed")
			if remote then
				remote:FireServer("Candy Blossom", 1)
				print("[‚úî] Attempted to buy Candy Blossom.")
			else
				warn("[‚úñ] Remote 'BuySeed' not found.")
			end
		end)
		if not success then warn("[Buy Error]:", err) end
	end
end)

-- üçé Check fruit names even with mutation/kg
local function isTargetFruit(name)
	for _, keyword in ipairs(fruitNames) do
		if name:lower():find(keyword:lower()) then
			return true
		end
	end
	return false
end

-- üîÑ Loop
task.spawn(function()
	while true do
		task.wait(0.4)
		if not autoCollect and not autoGive then continue end

		for _, obj in pairs(workspace:GetDescendants()) do
			if obj:IsA("ProximityPrompt") and obj.Parent and obj.Parent:IsA("BasePart") then
				local fruitName = obj.Parent.Name
				if isTargetFruit(fruitName) then
					local distance = (hrp.Position - obj.Parent.Position).Magnitude
					if distance <= obj.MaxActivationDistance then
						pcall(function()
							if autoCollect or autoGive then
								fireproximityprompt(obj)
							end
						end)
					end
				end
			end
		end
	end
end)
